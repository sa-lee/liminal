
<!-- README.md is generated from README.Rmd. Please edit that file -->

# liminal

<!-- badges: start -->

[![Lifecycle:
experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
<!-- badges: end -->

The goal of `liminal` is to provide diganostics and visual analytics for
understanding embedding algorithms such as tSNE. It has been
[shown](https://distill.pub/2016/misread-tsne/) that in order to produce
an effective embedding may one have to play with hyperparamters and
various settings for these algorithms.

`liminal` aims to increase the effective use of these algorithms by
combining them with interactive and dynamic graphics (via the vegawidget
and shiny packages) and with a technique from multivariate stastics
called the tour (via the tourr package). Briefly, a tour is a sequence
of interploated projections of multivariate data onto lower dimensional
space. The sequence is displayed as a dynamic visualisation, and enables
us to see the shadows of the high dimensional data makes in a lower
dimensional view. By combining the tour with embedding algorithms, we
can see the following:

1.  whether distances in the embedding view are meaningful
2.  the local and global structure of the data
3.  identify ‘interesting’ shapes or points in the data

## Quick start

Let’s take a look at a high-dimensional tree structured data set:

``` r
library(liminal)
dplyr::glimpse(fake_trees)
#> Observations: 3,000
#> Variables: 101
#> $ dim1     <dbl> -6.31860422, -2.98339317, 1.75443392, -0.49834285, 2.0206307…
#> $ dim2     <dbl> 1.9132148, 5.3128376, 3.6995467, 4.1682321, -4.2645013, -2.3…
#> $ dim3     <dbl> -0.9079466, -5.2765917, 4.1095057, -1.6196486, -0.8456673, -…
#> $ dim4     <dbl> -2.80074194, -2.69090033, -2.30241239, 0.07108289, -2.297833…
#> $ dim5     <dbl> -0.1578351, -0.2092053, -4.3522832, 7.4028651, 5.7076420, 2.…
#> $ dim6     <dbl> -2.3726781, 5.3991111, 1.2661616, -0.7941823, 1.3590657, 5.4…
#> $ dim7     <dbl> -5.4554570, 6.0732723, 2.1710735, -0.7244374, 4.0943664, 7.2…
#> $ dim8     <dbl> -4.9487209, -2.8949017, -1.0865261, 1.6878266, -2.6204286, 2…
#> $ dim9     <dbl> 3.34594668, 7.90099048, 3.29733588, -6.63976567, -4.31917027…
#> $ dim10    <dbl> 1.60070302, 4.64252145, -1.83768248, -0.65201997, 5.52709152…
#> $ dim11    <dbl> 0.2792004, 3.0663882, 1.8765418, 3.6838190, -5.6011434, 4.64…
#> $ dim12    <dbl> -0.3243474, -5.7332423, 4.5628857, 5.9622366, -6.2597848, -0…
#> $ dim13    <dbl> -4.30299725, 1.10348012, 6.73892786, 3.69318407, -3.80699948…
#> $ dim14    <dbl> -1.8572238, 2.5096166, 0.6612332, -5.0902058, -7.6749579, -2…
#> $ dim15    <dbl> 5.34919386, 2.73146877, -0.50896876, -2.82831876, -2.6159122…
#> $ dim16    <dbl> -6.6291864, -5.9686639, -4.6070894, 0.3470759, 2.2577697, 3.…
#> $ dim17    <dbl> 5.1458019, -1.1000555, 1.8801047, -3.2331178, 3.5537626, 2.7…
#> $ dim18    <dbl> 3.10718120, -5.33187637, 2.90650684, 1.81236077, 2.29360782,…
#> $ dim19    <dbl> 7.31800264, 1.87652335, -4.57655007, 1.86244480, -2.39027716…
#> $ dim20    <dbl> 5.6822720, 2.7787615, 5.9422349, 3.7657048, -8.3092804, -6.6…
#> $ dim21    <dbl> -1.572943, -1.305164, 2.069874, -6.358180, -3.484739, 4.2743…
#> $ dim22    <dbl> -7.4207931, -3.4207703, -3.8688923, 4.6145118, -3.6628431, -…
#> $ dim23    <dbl> -3.81139668, -0.88452732, 1.56890004, -0.03344118, -2.116024…
#> $ dim24    <dbl> -3.4754930, 1.8304269, 3.6790555, -2.0729217, -1.8161689, 1.…
#> $ dim25    <dbl> 4.86304195, 3.20346217, -3.65852663, 2.85178828, 1.48405036,…
#> $ dim26    <dbl> -2.8707765, 0.6201456, 0.9860271, 4.7267990, -0.1442902, 8.0…
#> $ dim27    <dbl> 2.4448709, 4.6094870, -4.1287558, 3.2289225, 1.9393851, 5.13…
#> $ dim28    <dbl> 3.0242715, 3.8378066, 1.0705867, 1.9856088, 4.9105333, 1.367…
#> $ dim29    <dbl> -3.3577504, -7.2096707, 4.3875034, 0.3827461, 1.1192996, 5.2…
#> $ dim30    <dbl> 7.7317880, 1.7197283, -2.1317867, -2.5745616, -1.0909560, 0.…
#> $ dim31    <dbl> -0.8875026, 8.9367561, -9.3863532, 1.6927286, -0.4742578, 2.…
#> $ dim32    <dbl> -9.4519331, -0.6760768, 2.2081731, 0.4330668, -1.7943012, 4.…
#> $ dim33    <dbl> -5.6465401, 0.2088784, -6.9579862, -1.5058338, 4.1257841, 9.…
#> $ dim34    <dbl> -3.9004459, 3.1584757, -0.9987300, 3.8609913, -1.3290262, -7…
#> $ dim35    <dbl> -7.6463995, -2.2646317, -5.1235609, -5.3408816, 0.2296863, 2…
#> $ dim36    <dbl> 1.3982753, -5.3861117, -0.8907711, -0.5989402, 0.8655496, -5…
#> $ dim37    <dbl> -0.618425627, 4.725590289, -1.192869404, -6.336126894, 1.565…
#> $ dim38    <dbl> -5.97431913, 3.56075664, -5.31762841, -1.29871586, -0.961187…
#> $ dim39    <dbl> 3.4818963, 7.8109771, -1.6062002, -3.4852963, 2.8677389, -1.…
#> $ dim40    <dbl> 5.67520839, -0.03678129, -1.04767800, -1.10851756, -2.601413…
#> $ dim41    <dbl> -7.39241342, -4.51506846, 1.12067255, -1.22297188, 0.8648841…
#> $ dim42    <dbl> 6.9057008, 4.2780295, 3.0144337, 2.1023307, 1.6617532, 10.08…
#> $ dim43    <dbl> 5.2208686, 1.8714102, -0.4604013, -2.6579091, 1.1048476, 1.7…
#> $ dim44    <dbl> 0.9359570, -7.4001982, 3.0895643, -6.2550757, 8.9909379, -0.…
#> $ dim45    <dbl> -3.85018738, -0.62377525, -0.24396598, 2.98121143, 0.1328047…
#> $ dim46    <dbl> 2.457791, -3.148952, 8.595200, 5.909657, 2.983850, 1.026078,…
#> $ dim47    <dbl> 1.7987845, -3.0482016, 0.5663015, 0.9189741, -3.7601256, -0.…
#> $ dim48    <dbl> -2.3436536, 0.2513360, 3.8701945, -1.9933708, 1.4727348, -6.…
#> $ dim49    <dbl> -2.03998852, 3.18543398, 0.98159875, 1.17149762, -0.08287118…
#> $ dim50    <dbl> -2.4162749, -6.3000455, -1.7614020, 5.3624051, -4.1696926, -…
#> $ dim51    <dbl> 3.3116119, -0.6633248, -1.4666147, -11.1746456, 6.4136171, 1…
#> $ dim52    <dbl> -1.2791727, -2.3917928, -3.6424418, 2.0620763, 4.7213335, 3.…
#> $ dim53    <dbl> -0.5963072, 4.6407709, 2.6612205, 6.6288290, 2.5613297, 2.61…
#> $ dim54    <dbl> -2.29354189, 2.38477749, 0.93227237, 3.65576086, -2.88814040…
#> $ dim55    <dbl> 4.65916314, 6.65880703, -7.59735857, 4.01982566, -2.80921424…
#> $ dim56    <dbl> 4.4869733, -0.2927944, -3.3562315, -5.3364719, -4.1990108, 2…
#> $ dim57    <dbl> 1.81663640, -1.53424550, 4.12497714, -2.81658122, 3.39596546…
#> $ dim58    <dbl> -0.5789730, -4.3032177, 0.9469323, 3.0967221, -8.1129029, -0…
#> $ dim59    <dbl> -1.31598517, 2.60834844, -0.72409093, -0.08617105, -3.661373…
#> $ dim60    <dbl> 1.3263655, 1.2119538, -3.8934858, -5.1327718, 6.5921053, 0.8…
#> $ dim61    <dbl> -1.7769948, -7.1828780, -6.0706974, -3.0500309, -6.1199777, …
#> $ dim62    <dbl> -5.44881242, -3.27008494, 3.98633494, -3.42656982, 5.4587022…
#> $ dim63    <dbl> -0.51503031, 0.27741839, 1.06050956, 1.15400210, 5.54412827,…
#> $ dim64    <dbl> -4.9670529, 3.0245409, 2.0167336, -0.2428468, 6.9851028, 1.0…
#> $ dim65    <dbl> -3.0543597, -0.6882900, -3.3617690, 5.2475060, -5.0738287, -…
#> $ dim66    <dbl> 3.9010556, -6.5051839, 3.6243203, 0.9090459, 0.7766015, -7.9…
#> $ dim67    <dbl> 8.5787917, 2.9416177, -5.0954177, -4.0447161, -2.8660379, 0.…
#> $ dim68    <dbl> -3.0114224, -1.3819881, 2.3868129, -9.4268800, -7.9734915, 4…
#> $ dim69    <dbl> 2.37528081, -5.61809264, -5.24449945, 0.25985664, -10.747000…
#> $ dim70    <dbl> 1.6126176, 0.3289240, -4.7451771, 5.0325584, 2.6717288, -1.1…
#> $ dim71    <dbl> 2.9214158, 8.1291733, -1.9992512, 9.6721089, 3.0829992, -1.0…
#> $ dim72    <dbl> 4.4649242, -3.7207309, -1.0402043, -4.3678173, 7.1392389, -0…
#> $ dim73    <dbl> 1.5446611, 4.6988286, -3.4448877, 6.4568638, -0.9458560, -4.…
#> $ dim74    <dbl> -0.316710145, -4.039672306, 4.183903671, 0.004988027, -2.988…
#> $ dim75    <dbl> 1.16796311, 0.05399706, 5.05022145, 0.89916963, 1.08647508, …
#> $ dim76    <dbl> 0.8116127, -2.3908748, 4.7483550, -5.3288376, -0.2265549, -1…
#> $ dim77    <dbl> 5.5132938, 0.5619753, 3.7701034, 3.2303886, 5.0158437, -1.34…
#> $ dim78    <dbl> 5.69171753, -1.31126815, 1.29420199, 2.58676874, 0.45548749,…
#> $ dim79    <dbl> -7.9385287, -7.9777045, -0.4236691, 3.1340825, -2.0273838, -…
#> $ dim80    <dbl> -5.8180353, -4.7237242, -4.4593400, -2.1093358, 1.8026648, 1…
#> $ dim81    <dbl> 6.7944294, 2.1228121, -6.1874633, -2.5545249, 1.6949041, 2.5…
#> $ dim82    <dbl> -4.3141868, 7.2503743, -1.8292497, -1.5420170, -2.3126209, -…
#> $ dim83    <dbl> 6.6865356, -3.9631888, 4.2299670, -5.9449552, -3.0760693, -1…
#> $ dim84    <dbl> -1.0832386, 1.9341110, -5.0436665, 1.0648555, -3.0334158, 4.…
#> $ dim85    <dbl> -6.2215945, -2.4886424, 0.5071591, 3.7743569, 2.9440841, -0.…
#> $ dim86    <dbl> -8.54930144, -0.26664605, 1.73793868, -0.09047549, 2.4125714…
#> $ dim87    <dbl> 0.6436511, -5.1906327, -4.0408254, 3.7342121, -7.4975506, 0.…
#> $ dim88    <dbl> -1.56394543, 3.44323566, 1.44684153, -0.44166384, -2.2155639…
#> $ dim89    <dbl> -4.83623354, -2.88901646, -5.47961081, 3.07003380, 3.6527402…
#> $ dim90    <dbl> -3.32753760, 0.97726287, 4.09640502, -0.03171178, -4.7797801…
#> $ dim91    <dbl> -4.0296987, 1.9036539, -1.0964016, 2.7589359, -0.3256437, 11…
#> $ dim92    <dbl> 5.3313790, -5.2850267, -3.3004877, 6.2570439, -0.5922655, 0.…
#> $ dim93    <dbl> -1.35615802, -0.67970849, -0.28926366, -7.03882457, 0.057428…
#> $ dim94    <dbl> -1.6087618, 2.0553204, -0.4777860, 0.4265619, 4.9701295, 3.7…
#> $ dim95    <dbl> 4.5605719, 1.7250638, -8.6828366, 0.8032179, -5.9070886, -3.…
#> $ dim96    <dbl> -2.17032177, 2.75028710, 0.53204427, -4.93408311, -4.3704706…
#> $ dim97    <dbl> -2.7473140, 5.7020969, -4.4261795, -5.6754571, 0.1517633, -6…
#> $ dim98    <dbl> 0.23922915, 6.05836106, -10.33027415, -1.25805961, -5.542436…
#> $ dim99    <dbl> 2.1926712, 5.6364394, 1.5349644, -1.7897798, -8.0634370, -2.…
#> $ dim100   <dbl> 0.9747825, -0.4797132, -1.4402365, 2.6583954, 4.2733260, 4.1…
#> $ branches <fct> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
```

This data set has 3000 observations and 100 numeric variables, and has
ten branches. We can generate principal components:

``` r
pcs  <- prcomp(fake_trees[, -ncol(fake_trees)])
# var explained
head(cumsum(pcs$sdev / sum(pcs$sdev)))
#> [1] 0.05569726 0.09768259 0.13586130 0.17200716 0.20405094 0.23398570
```

And visualise the results as interactive scatter plot by augmenting the
orginal data

``` r
fake_trees <- dplyr::bind_cols(fake_trees, as.data.frame(pcs$x))
limn_xy(fake_trees, x = PC1, y = PC2, color = branches)
```

<img src="man/figures/README-unnamed-chunk-4-1.png" width="100%" />

We see some separation of the branches in first two principal
components, however, we can’t see each of the branches clearly or their
relation to each other. We can tourr them to get an idea of underlying
structure:

``` r
# this loads a shiny app
limn_tour(fake_trees, PC1:PC15, color = branches)
```

The blue branch is hidden and connects all other branches.

We can also compare this to t-SNE embedding:

``` r
set.seed(2099)
tsne <- Rtsne::Rtsne(dplyr::select(fake_trees, dplyr::starts_with("dim")))

tsne_df <- data.frame(tsneX = tsne$Y[,1],
                      tsneY = tsne$Y[,2],
                      branches = fake_trees$branches)
limn_xy(tsne_df, x = tsneX, y = tsneY, color = branches)
```

<img src="man/figures/README-unnamed-chunk-6-1.png" width="100%" />

The topology is a little messed up. We can see where our embedding is
different via a linked scatter plot:

``` r
limn_tour_xylink(dplyr::select(fake_trees, PC1:PC10, branches),
                 tsne_df,
                 x_color = branches, 
                 y_color = branches)
```
