<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Explore non-linear embeddings with liminal • liminal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Explore non-linear embeddings with liminal">
<meta property="og:description" content="liminal">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">liminal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/liminal.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/geometry_parameter_space.html">Using liminal to understand high dimensional parameter space</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sa-lee/liminal/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="liminal_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Explore non-linear embeddings with liminal</h1>
                        <h4 data-toc-skip class="author">Stuart Lee</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sa-lee/liminal/blob/master/vignettes/liminal.Rmd" class="external-link"><code>vignettes/liminal.Rmd</code></a></small>
      <div class="hidden name"><code>liminal.Rmd</code></div>

    </div>

    
    
<p>The <strong>liminal</strong> R package is designed to help you understand and interrogate non-linear dimension reduction results via the (grand) tour and linked graphics. It offers two main functions that are useful for exploring high-dimensional datasets, <code><a href="../reference/limn_tour.html">limn_tour()</a></code> and <code><a href="../reference/limn_tour_link.html">limn_tour_link()</a></code>. Both of these functions create interactive visualisations that are embedded in either the RStudio Viewer pane or on a web browser through <strong>shiny</strong> <span class="citation">(Chang et al. <a href="#ref-R-shiny" role="doc-biblioref">2021</a>)</span>.</p>
<div id="touring-high-dimensional-space" class="section level1">
<h1 class="hasAnchor">
<a href="#touring-high-dimensional-space" class="anchor" aria-hidden="true"></a>Touring high-dimensional space</h1>
<p>A tour is a dynamic visualisation that is displayed as a smooth animation of low-dimensional projections. A high dimensional dataset is projected onto a sequence of lower dimensional targets (also called bases) enabling the tour to explore the subspace of all lower dimensional projections. The way that targets are generated is called the tour path, in <strong>liminal</strong> we default to using the grand tour, which generates random Gaussian targets, although any tour path available in the <strong>tourr</strong> package can be used <span class="citation">(Wickham et al. <a href="#ref-tourr2011" role="doc-biblioref">2011</a>; Wickham and Cook <a href="#ref-R-tourr" role="doc-biblioref">2021</a>)</span>. For more details, see <span class="citation">Lee et al. (<a href="#ref-Lee2021-gn" role="doc-biblioref">2021</a>)</span> for a review of tour methods and <span class="citation">Wickham et al. (<a href="#ref-tourr2011" role="doc-biblioref">2011</a>)</span> for their implementation in R.</p>
<p>Let’s take a look at an example, which has been adapted from the <strong>phateR</strong> package <span class="citation">(Srinivasan <a href="#ref-R-phateR" role="doc-biblioref">2021</a>; Moon et al. <a href="#ref-phateR2019" role="doc-biblioref">2019</a>)</span>..</p>
<p>The <strong>liminal</strong> package comes with a built in <code>data.frame</code> which is a high-dimensional tree structured dataset called <code>fake_trees</code>. It consists of 3000 observations over 100 numeric variables. The tree can really be embedded in 2 dimensions and has 10 branches.</p>
<p>First, let’s generate principal components:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sa-lee/liminal/" class="external-link">liminal</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"fake_trees"</span><span class="op">)</span>
<span class="va">pcs</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="va">fake_trees</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">fake_trees</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co"># var explained</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">pcs</span><span class="op">$</span><span class="va">sdev</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pcs</span><span class="op">$</span><span class="va">sdev</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.05569726 0.09768259 0.13586130 0.17200716 0.20405094 0.23398570</span></code></pre></div>
<p>And visualise the results as scatter plot by augmenting the original data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="va">fake_trees</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="va">fake_trees</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">pcs</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">fake_trees</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PC1</span>, y <span class="op">=</span> <span class="va">PC2</span>, color <span class="op">=</span> <span class="va">branches</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="../reference/palettes.html">limn_pal_tableau10</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="liminal_files/figure-html/pca-xy-1.png" width="700"></p>
<p>We see some separation of the branches in first two principal components, however, we can’t see each of the branches clearly or their relation to each other.</p>
<p>We can tour the components that represent most of the variation in the data to get a sense of the underlying structure.</p>
<p>The following code generates a shiny application, that provides an interface to the tour:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># this loads a shiny app on the first fifteen PCs</span>
<span class="fu"><a href="../reference/limn_tour.html">limn_tour</a></span><span class="op">(</span><span class="va">fake_trees</span>, cols <span class="op">=</span> <span class="va">PC1</span><span class="op">:</span><span class="va">PC15</span>, color <span class="op">=</span> <span class="va">branches</span><span class="op">)</span></code></pre></div>
<p>The interface consists of the tour view which is a dynamic scatterplot and an axis view which corresponds to magnitude and direction of the generated targets.</p>
<p><img src="figures/limn_tour_basic.png" style="display: block; margin: auto;"></p>
<p>From the tour view, we can see that the blue branch is hidden (after highlighting it and letting the animation play) and forms the backbone of the tree.</p>
<p>Brushing on the tour view is activated with the shift key plus a mouse drag. It will highlight points that fall inside the brush and pause the current view.</p>
<p>There are several additional interactions available on this view: * There is a play button, that when pressed will start the tour. * There is also a text view of the half range which is the maximum squared Euclidean distance between points in the tour view. The half range is a scale factor for projections and can be thought of as a way of zooming in and out on points. It can be dynamically modified by scrolling (via a mouse-wheel). To reset double click the tour view. * The legend can be toggled to highlight groups of points with shift+mouse-click. Multiple groups can be selected in this way. To reset double click the legend title.</p>
</div>
<div id="adding-non-linear-embeddings" class="section level1">
<h1 class="hasAnchor">
<a href="#adding-non-linear-embeddings" class="anchor" aria-hidden="true"></a>Adding non-linear embeddings</h1>
<p>We can also compare this to t-SNE embedding run with default settings:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2099</span><span class="op">)</span>
<span class="va">tsne</span> <span class="op">&lt;-</span> <span class="fu">Rtsne</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rtsne/man/Rtsne.html" class="external-link">Rtsne</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">fake_trees</span>, <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"dim"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">tsne_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>tsneX <span class="op">=</span> <span class="va">tsne</span><span class="op">$</span><span class="va">Y</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,
                      tsneY <span class="op">=</span> <span class="va">tsne</span><span class="op">$</span><span class="va">Y</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tsne_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tsneX</span>, y <span class="op">=</span> <span class="va">tsneY</span>, color <span class="op">=</span> <span class="va">fake_trees</span><span class="op">$</span><span class="va">branches</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="../reference/palettes.html">limn_pal_tableau10</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="liminal_files/figure-html/tsne-xy-1.png" width="700"></p>
<p>The topology is a little messed up as the blue branch is now broken into two distinct pieces.</p>
<p>We can see where our embedding is different via a linked tour:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/limn_tour_link.html">limn_tour_link</a></span><span class="op">(</span>embed_data <span class="op">=</span> <span class="va">tsne_df</span>,
               tour_data <span class="op">=</span> <span class="va">fake_trees</span>,
               cols <span class="op">=</span> <span class="va">PC1</span><span class="op">:</span><span class="va">PC10</span>, <span class="co"># tour columns to select</span>
               color <span class="op">=</span> <span class="va">branches</span> <span class="co"># variable to highlight across both view, can come for either data frames</span>
<span class="op">)</span></code></pre></div>
<p>This function requires two tables that will be linked together in separate views. The tour interface is the same as above, except now brushing on the tour view will highlight points on the right hand side scatter plot. The right hand side scatterplot view is an interactive scatterplot.<br>
Brushing on the right view is activated via click and drag movements.</p>
<p><img src="figures/limn_tour_linked.png" style="display: block; margin: auto;"></p>
<p>We can see from brushing on the right, where t-SNE has broken up the global structure in the data and distorted the distance between points. For either interface, you can assign the results to an R object, that will return a list consisting of the selected basis (target) and the brushing bounding boxes.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/limn_tour_link.html">limn_tour_link</a></span><span class="op">(</span>embed_data <span class="op">=</span> <span class="va">tsne_df</span>,
               tour_data <span class="op">=</span> <span class="va">fake_trees</span>,
               cols <span class="op">=</span> <span class="va">PC1</span><span class="op">:</span><span class="va">PC10</span>, <span class="co"># tour columns to select</span>
               color <span class="op">=</span> <span class="va">branches</span> <span class="co"># variable to highlight across both view, can come for either data frames</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor" aria-hidden="true"></a>References</h1>
<div id="refs" class="references">
<div id="ref-R-shiny">
<p>Chang, Winston, Joe Cheng, JJ Allaire, Carson Sievert, Barret Schloerke, Yihui Xie, Jeff Allen, Jonathan McPherson, Alan Dipert, and Barbara Borges. 2021. <em>Shiny: Web Application Framework for R</em>. <a href="https://shiny.rstudio.com/" class="external-link">https://shiny.rstudio.com/</a>.</p>
</div>
<div id="ref-Lee2021-gn">
<p>Lee, Stuart, Dianne Cook, Natalia da Silva, Ursula Laa, Earo Wang, Nick Spyrison, and H Sherry Zhang. 2021. “A Review of the State-of-the-Art on Tours for Dynamic Visualization of High-Dimensional Data,” April. <a href="https://arxiv.org/abs/2104.08016" class="external-link">https://arxiv.org/abs/2104.08016</a>.</p>
</div>
<div id="ref-phateR2019">
<p>Moon, Kevin R, David van Dijk, Zheng Wang, Scott Gigante, Daniel B Burkhardt, William S Chen, Kristina Yim, et al. 2019. “Visualizing Structure and Transitions in High-Dimensional Biological Data.” <em>Nature Biotechnology</em> 37 (12): 1482–92. <a href="https://doi.org/10.1038/s41587-019-0336-3" class="external-link">https://doi.org/10.1038/s41587-019-0336-3</a>.</p>
</div>
<div id="ref-R-phateR">
<p>Srinivasan, Krishnan. 2021. <em>PhateR: PHATE - Potential of Heat-Diffusion for Affinity-Based Transition Embedding</em>. <a href="https://CRAN.R-project.org/package=phateR" class="external-link">https://CRAN.R-project.org/package=phateR</a>.</p>
</div>
<div id="ref-R-tourr">
<p>Wickham, Hadley, and Di Cook. 2021. <em>Tourr: Tour Methods for Multivariate Data Visualisation</em>. <a href="https://github.com/ggobi/tourr" class="external-link">https://github.com/ggobi/tourr</a>.</p>
</div>
<div id="ref-tourr2011">
<p>Wickham, Hadley, Dianne Cook, Heike Hofmann, and Andreas Buja. 2011. “tourr: An R Package for Exploring Multivariate Data with Projections.” <em>Journal of Statistical Software</em> 40 (2): 1–18. <a href="https://www.jstatsoft.org/v40/i02/" class="external-link">https://www.jstatsoft.org/v40/i02/</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://stuartlee.org" class="external-link external-link">Stuart Lee</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
